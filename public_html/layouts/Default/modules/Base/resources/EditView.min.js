jQuery.Class("Base_EditView_Js",{},{container:false,getContainer:function(){if(this.container==false){this.container=jQuery(".mainContent")}return this.container},referenceModulePopupRegisterEvent:function(a){var b=this;if(a==undefined){a=this.getContainer()}a.on("click",".relatedPopup",function(j){var h=jQuery(j.currentTarget);var k=h.closest(".fieldValue");var i=k.find(".sourceField");var g=i.attr("name");var f=i.data("fieldLabel");var d="index.php?module="+b.getReferencedModuleName(k)+"&view=ListView";var c=function(m){var l=new Base_ListView_Js();var e=l.registerDataTable();e.$(".listViewEntries tbody tr").off("click").on("click",function(o){o.stopPropagation();o.preventDefault();if($.contains(jQuery(o.currentTarget).find("td:first-child").get(0),o.target)){return}var n=jQuery(o.currentTarget).closest("tr");var p={id:n.data("record"),name:n.data("name")};b.setReferenceFieldValue(k,p);app.hideModalWindow()})};AppConnector.request(d).then(function(l){if(l){l=jQuery(l);l.find(".widget_header").remove();var e='<div class="modal fade modal'+g+'" id="modal'+g+'"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header">				<button class="close" data-dismiss="modal" title="'+app.translate("LBL_CLOSE")+'">x</button>				<h3 class="modal-title">'+f+' </h3>			</div>			<div class="modal-body">';e+=l.html();e+="</div></div></div><div>";app.showModalWindow(e,c)}},function(m,l){console.log([m,l])})});a.find(".referenceModulesList").chosen().change(function(h){var f=jQuery(h.currentTarget);var c=f.closest(".fieldValue");var i=f.val();var g=jQuery('input[name="popupReferenceModule"]',c);var d=g.val();g.val(i);if(d!=i){c.find(".clearReferenceSelection").trigger("click")}})},getReferencedModuleName:function(a){return jQuery('input[name="popupReferenceModule"]',a).val()},registerClearReferenceSelectionEvent:function(a){var b=this;a.on("click",".clearReferenceSelection",function(d){var c=jQuery(d.currentTarget);b.clearFieldValue(c);d.preventDefault()})},clearFieldValue:function(b){var e=this;var a=b.closest(".fieldValue");var g=a.find(".sourceField");var f=g.attr("name");var d=a.find('input[name="popupReferenceModule"]').val();var c=a.closest("form");g.val("");a.find("#"+f+"_display").removeAttr("readonly").val("")},setReferenceFieldValue:function(a,d){var i=this;var h=a.find("input.sourceField").attr("name");var c=a.find('input[name="'+h+'"]');var f=h+"_display";var j=a.find('input[name="'+f+'"]');var g=a.find('input[name="popupReferenceModule"]').val();var e=d.name;var b=d.id;c.val(b);j.val(e).attr("readonly",true)},registerValidationsFields:function(a){var b=this;var c=app.validationEngineOptions;a.validationEngine(c)},registerMaskFields:function(a){var b=this;a.find(":input").inputmask()},registerRecordSave:function(a){var b=a.find("form");b.on("submit",function(f){if(b.validationEngine("validate")===true){f.preventDefault();var c=jQuery(f.currentTarget);var d=c.serializeFormData();AppConnector.request(d).then(function(g){var g=JSON.parse(g);var e=g.result;if(e.id){window.location.href="index.php?module="+app.getModuleName()+"&view=DetailView&record="+e.id}else{alert(e.message)}},function(h,g){console.log([h,g])})}else{app.formAlignmentAfterValidation(b)}})},registerEvents:function(){var a=this.getContainer();a.find("form").validationEngine(app.validationEngineOptions);this.referenceModulePopupRegisterEvent();this.registerClearReferenceSelectionEvent(a);this.registerValidationsFields(a);this.registerMaskFields(a);this.registerRecordSave(a)}});